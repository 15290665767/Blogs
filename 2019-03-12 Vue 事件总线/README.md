## Vue 事件总线

### 1. 目的
处理Vue中非父子关系组件之间的数据通讯。

### 2. 传统解决方案
在Vue1.~中组件之间通信主要通过$dispatch沿着父级向上传播，和通过$broadcast向下广播来实现。

组件树的事件流传播方式难以理解，对组件的功能进行扩展会越来越弱。同级组件间的通信问题变得更为复杂。

### 3. 事件总线概念
在Vue中可以通过事件总线作为沟通桥梁，所有组件共用相同的事件中心，无论组件处于组件树的哪一层都可以向该事件中心注册发送事件或接收事件。

可以通过实例化一个空的Vue实例实现，实质上仅仅实例化了一个仅仅具有实例方法，不具备 DOM 的实例，因此它非常的轻便。

### 4. 实例
```
/*
 * 方式-1
 * 实例化一个空对象
 * 创建一个文件，在需要引用的组件中单个引入
 * 创建 EventBus.js 文件
 * 使用场景: 非父子关系组件数据通讯比较少，在需要的组件中单个引入
 *
 */

import Vue from 'vue'
export const EventBus = new Vue()

```
```
/* 
 * 方式 2
 * 实例化一个空对象
 * 在Vue原型上添加一个空的Vue实例
 * 在 main.js 中添加
 * 使用场景: 非父子关系组件数据通讯比较多的情况下，不许在对每个组件单独引入
 *
 */

Vue.prototype.$EventBus = new Vue()
```

当我们创建好一个空的Vue实例之后，就可以在组件之间进行注册发送事件或接收事件

发送事件：
==this.$EventBus.$emit('event', 'data')==

接收事件:
==this.$EventBus.on('event', data => console.log(data))==


### 5. 注意
在组件销毁前，应当清除该组件上对事件中心注册发送的事件
```
beforeDestroy () {
  this.$EventBus.$off('event')
}
```